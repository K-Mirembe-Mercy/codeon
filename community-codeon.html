<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CODEON Africa Championship</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<style>
body{font-family:Arial; margin:0; background:dark green; transition:.3s;}
.dark{background:#111; color:white;}
header{background:black; color:white; padding:15px; text-align:center;}
button{padding:8px 15px; margin:5px; cursor:pointer; border:none; border-radius:5px;}
textarea,input,select{width:100%; padding:10px; margin:5px 0; border-radius:5px;}
section{padding:20px;}
.card{background:white; padding:15px; margin:15px auto; border-radius:10px; max-width:800px; box-shadow:0 2px 8px rgba(0,0,0,.2);}
.dark .card{background:#222; color:white;}
.leader-row{display:flex; justify-content:space-between; padding:6px; border-bottom:1px solid #ccc; transition:.3s;}
.leader-row:hover{transform:scale(1.02);}
.badge{padding:3px 6px; border-radius:4px; font-size:12px; animation:pulse 1s infinite;}
.gold{background:gold;} .silver{background:silver;} .bronze{background:#cd7f32;color:white;}
@keyframes pulse{0%{opacity:1;}50%{opacity:.6;}100%{opacity:1;}}
.flag{margin-right:5px;}
textarea{height:120px;}
h2{margin-top:0;}
@media(max-width:600px){.leader-row{flex-direction:column;}}
</style>
</head>
<body>

<header>
<h1>ğŸŒ CODEON Africa Championship</h1>
<button onclick="toggleMode()">Toggle Dark/Light</button>
<button onclick="logout()">Logout</button>
<nav>
  <a href="index.html">Home</a>
  <a href="enroll.html">Enroll</a>
  <a href="verify.html">Verify Certificate</a>
  <a href="community-codeon.html">Community</a>
</nav>
</header>

<section id="authSection">
<h2>Login / Sign Up</h2>
<input type="email" id="email" placeholder="Email"><br>
<input type="password" id="password" placeholder="Password"><br>
<input type="text" id="school" placeholder="School Name"><br>
<select id="country">
<option value="Uganda">Uganda</option>
<option value="Kenya">Kenya</option>
<option value="Nigeria">Nigeria</option>
<option value="Ghana">Ghana</option>
<option value="South Africa">South Africa</option>
</select><br>
<button onclick="signup()">Sign Up</button>
<button onclick="login()">Login</button>
</section>

<section id="main" style="display:none;">

<!-- Weekly Challenge -->
<div class="card">
<h2>ğŸ”¥ Weekly Challenge</h2>
<p>Constraint: Build a landing page without using &lt;table&gt; tags.</p>
<textarea id="challengeCode" placeholder="Write your HTML/CSS here..."></textarea>
<button onclick="submitChallenge()">Submit Challenge</button>
</div>

<!-- Peer Review -->
<div class="card">
<h2>ğŸ¤ Peer Review</h2>
<div id="reviewsContainer"></div>
<textarea id="reviewText" placeholder="Write review here..."></textarea>
<button onclick="submitReview()">Submit Review</button>
</div>

<!-- Leaderboards -->
<div class="card">
<h2>ğŸ† Africa Leaderboard</h2>
<div id="leaderboard"></div>
</div>

<div class="card">
<h2>ğŸ« School Championship</h2>
<div id="schoolBoard"></div>
</div>

<div class="card">
<h2>ğŸŒ Country Championship</h2>
<div id="countryBoard"></div>
</div>

<!-- Certificate -->
<div class="card">
<h2>ğŸ“œ Certificate</h2>
<div id="certificate"></div>
</div>

</section>

<script>
// ğŸ”¥ Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyD_LR9Kllj7hoKTiJAaSxyHglSO6r5gh-g",
  authDomain: "codeon-3cb1c.firebaseapp.com",
  projectId: "codeon-3cb1c"
};
firebase.initializeApp(firebaseConfig);
const auth=firebase.auth();
const db=firebase.firestore();

let currentUser=null;

// Fake competitors
const ugandaCoders = [
  {name: "BabiryeCoder", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "KatoDev", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "MukasaTech", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "MirembeWeb", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "AkelloDev", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "OkelloStack", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "MusisiCode", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "NamukasaLogic", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "KiraboBuilder", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "SanyuDev", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "MugishaTech", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "AsiimweCoder", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "AgabaDev", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "MbabaziWeb", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "BirungiCoder", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "KizzaTech", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "OtimDev", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "AumaStack", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "OchenCode", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "NasicheDev", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "NafunaWeb", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "NekesaCoder", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "IsabiryeTech", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "BwambaleDev", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "MuhindoStack", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "BiiraCode", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "MasikaDev", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "AtukundaWeb", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "KagumahoCoder", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "NsubugaTech", flag: "ğŸ‡ºğŸ‡¬"},
  {name: "LuleDev", flag: "ğŸ‡ºğŸ‡¬"}
];
  const ugandaStudents = [
  {name: "Emmanuel", points: Math.floor(Math.random()*100)+10, district: "Kampala"},
  {name: "Grace", points: Math.floor(Math.random()*100)+10, district: "Gulu"},
  {name: "Joseph", points: Math.floor(Math.random()*100)+10, district: "Mbarara"},
  {name: "Mary", points: Math.floor(Math.random()*100)+10, district: "Jinja"},
  {name: "Samuel", points: Math.floor(Math.random()*100)+10, district: "Mbale"},
  {name: "Dorothy", points: Math.floor(Math.random()*100)+10, district: "Lira"},
  {name: "Pius", points: Math.floor(Math.random()*100)+10, district: "Masaka"},
  {name: "Mercy", points: Math.floor(Math.random()*100)+10, district: "Fort Portal"},
  {name: "Stephen", points: Math.floor(Math.random()*100)+10, district: "Soroti"},
  {name: "Proscovia", points: Math.floor(Math.random()*100)+10, district: "Hoima"},
  {name: "John", points: Math.floor(Math.random()*100)+10, district: "Kabale"},
  {name: "Elizabeth", points: Math.floor(Math.random()*100)+10, district: "Kitgum"},
  {name: "Andrew", points: Math.floor(Math.random()*100)+10, district: "Iganga"},
  {name: "Phiona", points: Math.floor(Math.random()*100)+10, district: "Masindi"},
  {name: "Patrick", points: Math.floor(Math.random()*100)+10, district: "Mukono"},
  {name: "Priscilla", points: Math.floor(Math.random()*100)+10, district: "Soroti"},
  {name: "Charles", points: Math.floor(Math.random()*100)+10, district: "Ntungamo"},
  {name: "Faith", points: Math.floor(Math.random()*100)+10, district: "Apac"},
  {name: "Christopher", points: Math.floor(Math.random()*100)+10, district: "Arua"},
  {name: "Resty", points: Math.floor(Math.random()*100)+10, district: "Kabarole"},
  {name: "Simon", points: Math.floor(Math.random()*100)+10, district: "Kayunga"},
  {name: "Sarah", points: Math.floor(Math.random()*100)+10, district: "Kumi"},
  {name: "Francis", points: Math.floor(Math.random()*100)+10, district: "Nakasongola"},
  {name: "Noeline", points: Math.floor(Math.random()*100)+10, district: "Koboko"},
  {name: "David", points: Math.floor(Math.random()*100)+10, district: "Amuru"},
  {name: "Immaculate", points: Math.floor(Math.random()*100)+10, district: "Nakapiripirit"},
  {name: "Peter", points: Math.floor(Math.random()*100)+10, district: "Rukungiri"},
  {name: "Annet", points: Math.floor(Math.random()*100)+10, district: "Yumbe"},
  {name: "Moses", points: Math.floor(Math.random()*100)+10, district: "Soroti"},
  {name: "Agnes", points: Math.floor(Math.random()*100)+10, district: "Kabarole"}
];
  const ugandaDistricts = [
  {name: "Babirye", district: "Kampala"},
  {name: "Kato", district: "Gulu"},
  {name: "Mukasa", district: "Mbarara"},
  {name: "Mirembe", district: "Jinja"},
  {name: "Akello", district: "Mbale"},
  {name: "Okello", district: "Lira"},
  {name: "Musisi", district: "Masaka"},
  {name: "Namukasa", district: "Fort Portal"},
  {name: "Kirabo", district: "Soroti"},
  {name: "Sanyu", district: "Hoima"},
  {name: "Mugisha", district: "Kabale"},
  {name: "Asiimwe", district: "Kitgum"},
  {name: "Agaba", district: "Iganga"},
  {name: "Mbabazi", district: "Masindi"},
  {name: "Birungi", district: "Mukono"},
  {name: "Kizza", district: "Soroti"},
  {name: "Otim", district: "Ntungamo"},
  {name: "Auma", district: "Apac"},
  {name: "Ochen", district: "Arua"},
  {name: "Nasiche", district: "Kabarole"}
];
  
// Auth
function signup(){
  auth.createUserWithEmailAndPassword(email.value,password.value)
  .then(u=>{
    db.collection("users").doc(u.user.uid).set({email:email.value,school:school.value,country:country.value,points:0});
  });
}
function login(){auth.signInWithEmailAndPassword(email.value,password.value);}
function logout(){auth.signOut();}

auth.onAuthStateChanged(user=>{
  if(user){
    currentUser=user;
    authSection.style.display="none";
    main.style.display="block";
    loadBoards();
    loadPeerReviews();
  } else {authSection.style.display="block"; main.style.display="none";}
});

// Submit challenge
function submitChallenge(){
  let code=challengeCode.value;
  let score=Math.floor(Math.random()*50)+50;
  db.collection("users").doc(currentUser.uid).update({points:firebase.firestore.FieldValue.increment(score)});
  alert("AI Score: "+score+" points awarded!");
  generateCertificate(score);
}

// Peer reviews
const fakeReviews = [
  "Great layout! ğŸ˜ Really intuitive and easy to navigate.",
  "Color contrast could be better ğŸ¤” Some text is hard to read.",
  "Responsive design rocks! Checked on my phone & tablet ğŸ“±ğŸ’»",
  "Flexbox would make alignment easier than using margins.",
  "Fonts are a bit inconsistent. Maybe pick 1 primary font? ğŸ–‹ï¸",
  "Loved the interactive charts! Super informative ğŸ“Š",
  "Menu should be sticky â€“ lost it while scrolling ğŸ˜…",
  "Login flow is smooth, but tooltips for newbies would help ğŸ‘€",
  "Minimalistic & clean â€“ short and sweet ğŸ‘",
  "Buttons on mobile are tiny. Bigger tap targets pls ğŸ™",
  "Amazing work! The color palette is very professional ğŸ¨",
  "Sections feel cramped, add some spacing for readability ğŸ“",
  "Animations are subtle but make the UI feel alive âœ¨",
  "Settings page was tricky to find ğŸ¤· A sidebar might help",
  "Icons match the theme perfectly. Nice attention to detail ğŸ‘Œ",
  "Typography is clear & readable even on small screens ğŸ“–",
  "Hover effects on clickable items would improve UX ğŸ‘†",
  "Footer is text-heavy; maybe split into columns or shorten it ğŸ—‚ï¸",
  "Overall, very clean interface, easy to use & understand ğŸ’¯",
  "Add onboarding tips for first-time users â€“ smoothens the experience ğŸ› ï¸"
];

// Function to shuffle and slightly vary phrasing
function getRandomReviews() {
  // Shuffle array
  const shuffled = fakeReviews
    .map(r => ({text: r, sort: Math.random()}))
    .sort((a, b) => a.sort - b.sort)
    .map(r => r.text);

  // Slight variations: add prefixes or emojis randomly
  return shuffled.map(r => {
    const prefixes = ["ğŸ‘", "ğŸ’¡", "ğŸ‘€", "âœ…", "ğŸ”¥"];
    const suffixes = ["!", ".", " ğŸ˜„", " ğŸ™", "âœ¨"];
    const addPrefix = Math.random() > 0.6 ? prefixes[Math.floor(Math.random() * prefixes.length)] + " " : "";
    const addSuffix = Math.random() > 0.5 ? suffixes[Math.floor(Math.random() * suffixes.length)] : "";
    return addPrefix + r + addSuffix;
  });
}

// Usage
function loadPeerReviews() {
  let html = getRandomReviews().map(r => `<div class="leader-row">ğŸ’» ${r}</div>`).join("");

  db.collection("reviews").get().then(snap => {
    snap.forEach(doc => {
      html += `<div class="leader-row">ğŸ‘¤ ${doc.data().user}: ${doc.data().text}</div>`;
    });
    reviewsContainer.innerHTML = html;
  });
}
}
function submitReview(){
  db.collection("reviews").add({text:reviewText.value,user:currentUser.email}).then(()=>{reviewText.value=""; loadPeerReviews(); alert("Review Submitted!")});
}

// Leaderboards
function fillLeaderboard(realUsers,fakeList,total){
  let combined=[...realUsers];
  let needed=total-combined.length;
  let shuffledFakes=fakeList.sort(()=>Math.random()-.5).slice(0,needed);
  shuffledFakes=shuffledFakes.map(f=>({...f,points:Math.floor(Math.random()*120)+10}));
  combined=[...combined,...shuffledFakes];
  combined.sort((a,b)=>b.points-a.points);
  return combined.slice(0,total);
}
function renderAfricaBoard(users){
  const real=users.map(u=>({name:u.email,points:u.points,flag:"ğŸ‡ºğŸ‡¬"}));
  const top31=fillLeaderboard(real,fakeAfrica,31);
  leaderboard.innerHTML=top31.map((p,i)=>`<div class="leader-row">${i+1}. <span class="flag">${p.flag||"ğŸŒ"}</span> ${p.name} - ${p.points} pts</div>`).join("");
}
function renderSchoolBoard(users){
  const top50=fillLeaderboard(users.map(u=>({name:u.email,points:u.points,school:u.school})),fakeSchools,50);
  schoolBoard.innerHTML=top50.map((p,i)=>`<div class="leader-row">${i+1}. ${p.name} (${p.school}) - ${p.points} pts</div>`).join("");
}
function renderCountryBoard(users){
  const top43=fillLeaderboard(users.map(u=>({name:u.email,points:u.points,country:u.country})),fakeCountries,43);
  countryBoard.innerHTML=top43.map((p,i)=>`<div class="leader-row">${i+1}. ${p.name} (${p.country}) - ${p.points} pts</div>`).join("");
}
function loadBoards(){
  db.collection("users").onSnapshot(snapshot=>{
    let users=[]; snapshot.forEach(doc=>{users.push(doc.data());});
    renderAfricaBoard(users);
    renderSchoolBoard(users);
    renderCountryBoard(users);
  });
}

// Certificate
function generateCertificate(score){
  certificate.innerHTML=`<h3>CODEON Africa Championship Certificate</h3><p>${currentUser.email}</p><p>Awarded ${score} points</p>`;
}

// Dark mode
function toggleMode(){document.body.classList.toggle("dark");}
</script>

</body>
</html>
